# About

MAX7219内蔵の8桁7セグメントLEDディスプレイをドライブするコードです。本コードでは以下の回路図を用いているものとして書いていますので必要に応じて変更してください</br>
[購入元](https://www.amazon.co.jp/dp/B09FZ4S5JQ/)</br>

# 製品仕様

制御用のICにMAX7219を搭載した7セグメントLEDです</br>
基板についている端子は上から順にVCC, GND, DIN, CS, CLKです。</br>

![](img/IMG_4257.JPG)

各端子の役割を以下に示します

| 端子名 | 役割 | 使い方 |
|----|----|----|
| Vcc | 電源 | マイコン等から5Vを供給する |
| GND | グランド | 基準電位となる |
| DIN | デジタル信号入力 | レジスタに送るデータを入力 |
| CS | チップセレクト | 送信する前にLOWにし、送信が完了したらHIGHにする |
| CLK | クロック | レジスタのデータをシフトさせるクロック信号を入力 |



# 回路図（ブレッドボード）

![](img/IMG_4256.JPG)
![](img/IMG_4258.JPG)

このように繋ぐと、</br>

D12 <--> DIN</br>
D11 <--> CS</br>
D10 <--> CLK</br>

となります。電源は届きようがないのでジャンパ線を使用します</br>

操作用にタクトスイッチも入れています。GNDとD3に繋がっていて、内部プルアップを使用することでプルアップ抵抗を削減しています

# レジスタ関連

![](img/TimingChart-and-DataFormat.png)

レジスタに送信するデータは16bitで構成されています。LSBから順にデータ8bit、アドレス4bit、割り当てなし4bitです

![](functionDiagram.png)

動作はこのようになっています

データを送信する前にCSをLOWにし、DINに送信したいデータを入れてCLKを叩きます。DINにはMSBから送信します。
つまり、0を4bit、レジスタアドレス4bit、データ8bitの順になります。Arduino標準の`shiftOut();` 関数が便利です

## レジスタアドレスマップ

![](img/Register.png)

レジスタに送信するデータは上記の表の通りです。0x00 ~ 0x0Fの範囲で指定します

デコードモードレジスタ、シャットダウンレジスタへの送信データは以下の通りです

![](img/decodeModeRegister.png)
![](img/shutDownRegister.png)

デコードモード無効時に送信するデータと各bit-LEDの対応は以下の通りです

![](img/registerMap.png)
![](img/7Seg-databit.png)
